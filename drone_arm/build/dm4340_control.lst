ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"dm4340_control.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "Model/dm4340_control.c"
  20              		.section	.text.float_to_uint,"ax",%progbits
  21              		.align	1
  22              		.global	float_to_uint
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	float_to_uint:
  28              	.LVL0:
  29              	.LFB134:
   1:Model/dm4340_control.c **** #include "dm4340_control.h"
   2:Model/dm4340_control.c **** #include "stm32f4xx_hal.h"
   3:Model/dm4340_control.c **** #include "bsp_can.h"
   4:Model/dm4340_control.c **** 
   5:Model/dm4340_control.c **** Motor_Inf mtr;//电机信息结构体
   6:Model/dm4340_control.c **** extern CAN_HandleTypeDef hcan1;//CAN总线接口声明
   7:Model/dm4340_control.c **** extern CAN_HandleTypeDef hcan2;
   8:Model/dm4340_control.c **** 
   9:Model/dm4340_control.c **** /**
  10:Model/dm4340_control.c ****  * 浮点数据归一化成无符号整数，常用于嵌入式系统的电机控制场景，特别
  11:Model/dm4340_control.c ****  * x：特定物理量
  12:Model/dm4340_control.c ****  * x_min，x_max：x的范围
  13:Model/dm4340_control.c ****  * bits：x需要转化的位范围
  14:Model/dm4340_control.c ****  */
  15:Model/dm4340_control.c **** int float_to_uint(float x, float x_min, float x_max, int bits)
  16:Model/dm4340_control.c **** {
  30              		.loc 1 16 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		@ link register save eliminated.
  17:Model/dm4340_control.c ****     /// Converts a float to an unsigned int, given range and number of bits ///
  18:Model/dm4340_control.c ****     float span = x_max - x_min;
  35              		.loc 1 18 5 view .LVU1
  36              		.loc 1 18 11 is_stmt 0 view .LVU2
  37 0000 31EE601A 		vsub.f32	s2, s2, s1
  38              	.LVL1:
  19:Model/dm4340_control.c ****     float offset = x_min;
  39              		.loc 1 19 5 is_stmt 1 view .LVU3
ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 2


  20:Model/dm4340_control.c ****     return (int) ((x-offset)*((float)((1<<bits)-1))/span);
  40              		.loc 1 20 5 view .LVU4
  41              		.loc 1 20 21 is_stmt 0 view .LVU5
  42 0004 30EE600A 		vsub.f32	s0, s0, s1
  43              	.LVL2:
  44              		.loc 1 20 41 view .LVU6
  45 0008 0123     		movs	r3, #1
  46 000a 8340     		lsls	r3, r3, r0
  47              		.loc 1 20 48 view .LVU7
  48 000c 013B     		subs	r3, r3, #1
  49              		.loc 1 20 31 view .LVU8
  50 000e 07EE903A 		vmov	s15, r3	@ int
  51 0012 F8EEE77A 		vcvt.f32.s32	s15, s15
  52              		.loc 1 20 29 view .LVU9
  53 0016 20EE270A 		vmul.f32	s0, s0, s15
  54              		.loc 1 20 52 view .LVU10
  55 001a C0EE017A 		vdiv.f32	s15, s0, s2
  21:Model/dm4340_control.c **** }
  56              		.loc 1 21 1 view .LVU11
  57 001e FDEEE77A 		vcvt.s32.f32	s15, s15
  58 0022 17EE900A 		vmov	r0, s15	@ int
  59              	.LVL3:
  60              		.loc 1 21 1 view .LVU12
  61 0026 7047     		bx	lr
  62              		.cfi_endproc
  63              	.LFE134:
  65              		.section	.text.uint_to_float,"ax",%progbits
  66              		.align	1
  67              		.global	uint_to_float
  68              		.syntax unified
  69              		.thumb
  70              		.thumb_func
  72              	uint_to_float:
  73              	.LVL4:
  74              	.LFB135:
  22:Model/dm4340_control.c **** 
  23:Model/dm4340_control.c **** /**
  24:Model/dm4340_control.c ****  * 将归一化无符号整数还原成原始浮点数据
  25:Model/dm4340_control.c ****  * x：特定物理量
  26:Model/dm4340_control.c ****  * x_min，x_max：x的范围
  27:Model/dm4340_control.c ****  * bits：x需要转化的位范围
  28:Model/dm4340_control.c ****  */
  29:Model/dm4340_control.c ****     
  30:Model/dm4340_control.c **** float uint_to_float(int x_int, float x_min, float x_max, int bits)
  31:Model/dm4340_control.c **** {
  75              		.loc 1 31 1 is_stmt 1 view -0
  76              		.cfi_startproc
  77              		@ args = 0, pretend = 0, frame = 0
  78              		@ frame_needed = 0, uses_anonymous_args = 0
  79              		@ link register save eliminated.
  80              		.loc 1 31 1 is_stmt 0 view .LVU14
  81 0000 07EE900A 		vmov	s15, r0	@ int
  32:Model/dm4340_control.c ****     /// converts unsigned int to float, given range and number of bits ///
  33:Model/dm4340_control.c ****     float span = x_max - x_min;
  82              		.loc 1 33 5 is_stmt 1 view .LVU15
  83              		.loc 1 33 11 is_stmt 0 view .LVU16
  84 0004 70EEC00A 		vsub.f32	s1, s1, s0
ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 3


  85              	.LVL5:
  34:Model/dm4340_control.c ****     float offset = x_min;
  86              		.loc 1 34 5 is_stmt 1 view .LVU17
  35:Model/dm4340_control.c ****     return ((float)x_int)*span/((float)((1<<bits)-1)) + offset;
  87              		.loc 1 35 5 view .LVU18
  88              		.loc 1 35 13 is_stmt 0 view .LVU19
  89 0008 F8EEE77A 		vcvt.f32.s32	s15, s15
  90              		.loc 1 35 26 view .LVU20
  91 000c 27EEA07A 		vmul.f32	s14, s15, s1
  92              		.loc 1 35 43 view .LVU21
  93 0010 0123     		movs	r3, #1
  94 0012 8B40     		lsls	r3, r3, r1
  95              		.loc 1 35 50 view .LVU22
  96 0014 013B     		subs	r3, r3, #1
  97              		.loc 1 35 33 view .LVU23
  98 0016 07EE903A 		vmov	s15, r3	@ int
  99 001a F8EEE77A 		vcvt.f32.s32	s15, s15
 100              		.loc 1 35 31 view .LVU24
 101 001e C7EE276A 		vdiv.f32	s13, s14, s15
  36:Model/dm4340_control.c **** }
 102              		.loc 1 36 1 view .LVU25
 103 0022 36EE800A 		vadd.f32	s0, s13, s0
 104              	.LVL6:
 105              		.loc 1 36 1 view .LVU26
 106 0026 7047     		bx	lr
 107              		.cfi_endproc
 108              	.LFE135:
 110              		.section	.text.ctrl_motor,"ax",%progbits
 111              		.align	1
 112              		.global	ctrl_motor
 113              		.syntax unified
 114              		.thumb
 115              		.thumb_func
 117              	ctrl_motor:
 118              	.LVL7:
 119              	.LFB136:
  37:Model/dm4340_control.c **** 
  38:Model/dm4340_control.c **** //控制电机函数
  39:Model/dm4340_control.c **** void ctrl_motor(CAN_HandleTypeDef* hcan,uint16_t id, Motor_MIT_Data_t* _dm43_mit_t) //MIT模式
  40:Model/dm4340_control.c **** {
 120              		.loc 1 40 1 is_stmt 1 view -0
 121              		.cfi_startproc
 122              		@ args = 0, pretend = 0, frame = 24
 123              		@ frame_needed = 0, uses_anonymous_args = 0
 124              		.loc 1 40 1 is_stmt 0 view .LVU28
 125 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 126              	.LCFI0:
 127              		.cfi_def_cfa_offset 36
 128              		.cfi_offset 4, -36
 129              		.cfi_offset 5, -32
 130              		.cfi_offset 6, -28
 131              		.cfi_offset 7, -24
 132              		.cfi_offset 8, -20
 133              		.cfi_offset 9, -16
 134              		.cfi_offset 10, -12
 135              		.cfi_offset 11, -8
 136              		.cfi_offset 14, -4
ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 4


 137 0004 2DED028B 		vpush.64	{d8}
 138              	.LCFI1:
 139              		.cfi_def_cfa_offset 44
 140              		.cfi_offset 80, -44
 141              		.cfi_offset 81, -40
 142 0008 89B0     		sub	sp, sp, #36
 143              	.LCFI2:
 144              		.cfi_def_cfa_offset 80
 145 000a 0490     		str	r0, [sp, #16]
 146 000c 0591     		str	r1, [sp, #20]
 147 000e 1446     		mov	r4, r2
  41:Model/dm4340_control.c ****     uint8_t dm43_can_send_data[8];//can报文数据域
 148              		.loc 1 41 5 is_stmt 1 view .LVU29
  42:Model/dm4340_control.c ****     uint16_t pos_tmp,vel_tmp,kp_tmp,kd_tmp,tor_tmp;//临时存储转换后的整数值
 149              		.loc 1 42 5 view .LVU30
  43:Model/dm4340_control.c ****     
  44:Model/dm4340_control.c ****     pos_tmp = float_to_uint(_dm43_mit_t->p_int, P_MIN, P_MAX, 16);//目标位置
 150              		.loc 1 44 5 view .LVU31
 151              		.loc 1 44 15 is_stmt 0 view .LVU32
 152 0010 1368     		ldr	r3, [r2]	@ unaligned
 153 0012 00EE103A 		vmov	s0, r3	@ int
 154 0016 1020     		movs	r0, #16
 155              	.LVL8:
 156              		.loc 1 44 15 view .LVU33
 157 0018 B2EE091A 		vmov.f32	s2, #1.25e+1
 158 001c FAEE090A 		vmov.f32	s1, #-1.25e+1
 159 0020 FFF7FEFF 		bl	float_to_uint
 160              	.LVL9:
 161              		.loc 1 44 15 view .LVU34
 162 0024 0746     		mov	r7, r0
 163              		.loc 1 44 13 discriminator 1 view .LVU35
 164 0026 1FFA80FB 		uxth	fp, r0
 165              	.LVL10:
  45:Model/dm4340_control.c ****     vel_tmp = float_to_uint(_dm43_mit_t->v_int, V_MIN, V_MAX, 12);//目标速度
 166              		.loc 1 45 5 is_stmt 1 view .LVU36
 167              		.loc 1 45 15 is_stmt 0 view .LVU37
 168 002a 6368     		ldr	r3, [r4, #4]	@ unaligned
 169 002c 00EE103A 		vmov	s0, r3	@ int
 170 0030 0C20     		movs	r0, #12
 171 0032 B3EE0E1A 		vmov.f32	s2, #3.0e+1
 172 0036 FBEE0E0A 		vmov.f32	s1, #-3.0e+1
 173 003a FFF7FEFF 		bl	float_to_uint
 174              	.LVL11:
 175 003e 0646     		mov	r6, r0
 176              		.loc 1 45 13 discriminator 1 view .LVU38
 177 0040 1FFA80FA 		uxth	r10, r0
 178              	.LVL12:
  46:Model/dm4340_control.c ****     kp_tmp  = float_to_uint(_dm43_mit_t->kp_int, KP_MIN, KP_MAX, 12);//位置增益
 179              		.loc 1 46 5 is_stmt 1 view .LVU39
 180              		.loc 1 46 15 is_stmt 0 view .LVU40
 181 0044 9FED288A 		vldr.32	s16, .L5
 182 0048 A368     		ldr	r3, [r4, #8]	@ unaligned
 183 004a 00EE103A 		vmov	s0, r3	@ int
 184 004e 0C20     		movs	r0, #12
 185 0050 9FED261A 		vldr.32	s2, .L5+4
 186 0054 F0EE480A 		vmov.f32	s1, s16
 187 0058 FFF7FEFF 		bl	float_to_uint
ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 5


 188              	.LVL13:
 189              		.loc 1 46 13 discriminator 1 view .LVU41
 190 005c 0390     		str	r0, [sp, #12]
 191 005e BDF80C50 		ldrh	r5, [sp, #12]
 192              	.LVL14:
  47:Model/dm4340_control.c ****     kd_tmp  = float_to_uint(_dm43_mit_t->kd_int, KD_MIN, KD_MAX, 12);//微分增益
 193              		.loc 1 47 5 is_stmt 1 view .LVU42
 194              		.loc 1 47 15 is_stmt 0 view .LVU43
 195 0062 E368     		ldr	r3, [r4, #12]	@ unaligned
 196 0064 00EE103A 		vmov	s0, r3	@ int
 197 0068 0C20     		movs	r0, #12
 198 006a B1EE041A 		vmov.f32	s2, #5.0e+0
 199 006e F0EE480A 		vmov.f32	s1, s16
 200 0072 FFF7FEFF 		bl	float_to_uint
 201              	.LVL15:
 202 0076 8046     		mov	r8, r0
 203              		.loc 1 47 13 discriminator 1 view .LVU44
 204 0078 1FFA80F9 		uxth	r9, r0
 205              	.LVL16:
  48:Model/dm4340_control.c ****     tor_tmp = float_to_uint(_dm43_mit_t->t_int, T_MIN, T_MAX, 12);//前馈转矩
 206              		.loc 1 48 5 is_stmt 1 view .LVU45
 207              		.loc 1 48 15 is_stmt 0 view .LVU46
 208 007c 2369     		ldr	r3, [r4, #16]	@ unaligned
 209 007e 00EE103A 		vmov	s0, r3	@ int
 210 0082 0C20     		movs	r0, #12
 211 0084 B2EE041A 		vmov.f32	s2, #1.0e+1
 212 0088 FAEE040A 		vmov.f32	s1, #-1.0e+1
 213 008c FFF7FEFF 		bl	float_to_uint
 214              	.LVL17:
  49:Model/dm4340_control.c **** 	
  50:Model/dm4340_control.c **** 	dm43_can_send_data[0] = (pos_tmp >> 8); //位置高8位
 215              		.loc 1 50 2 is_stmt 1 view .LVU47
 216              		.loc 1 50 24 is_stmt 0 view .LVU48
 217 0090 4FEA1B2B 		lsr	fp, fp, #8
 218              	.LVL18:
 219              		.loc 1 50 24 view .LVU49
 220 0094 8DF818B0 		strb	fp, [sp, #24]
  51:Model/dm4340_control.c **** 	dm43_can_send_data[1] = pos_tmp; //位置低八位
 221              		.loc 1 51 2 is_stmt 1 view .LVU50
 222              		.loc 1 51 24 is_stmt 0 view .LVU51
 223 0098 8DF81970 		strb	r7, [sp, #25]
  52:Model/dm4340_control.c **** 	dm43_can_send_data[2] = (vel_tmp >> 4); //速度高八位
 224              		.loc 1 52 2 is_stmt 1 view .LVU52
 225              		.loc 1 52 24 is_stmt 0 view .LVU53
 226 009c 4FEA1A1A 		lsr	r10, r10, #4
 227              	.LVL19:
 228              		.loc 1 52 24 view .LVU54
 229 00a0 8DF81AA0 		strb	r10, [sp, #26]
  53:Model/dm4340_control.c **** 	dm43_can_send_data[3] = ((vel_tmp&0xF)<<4)|(kp_tmp>>8); //速度低4位+kp高4位
 230              		.loc 1 53 2 is_stmt 1 view .LVU55
 231              		.loc 1 53 44 is_stmt 0 view .LVU56
 232 00a4 2D0A     		lsrs	r5, r5, #8
 233              	.LVL20:
 234              		.loc 1 53 44 view .LVU57
 235 00a6 45EA0615 		orr	r5, r5, r6, lsl #4
 236              		.loc 1 53 24 view .LVU58
 237 00aa 8DF81B50 		strb	r5, [sp, #27]
ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 6


  54:Model/dm4340_control.c **** 	dm43_can_send_data[4] = kp_tmp; //kp低八位
 238              		.loc 1 54 2 is_stmt 1 view .LVU59
 239              		.loc 1 54 24 is_stmt 0 view .LVU60
 240 00ae 039B     		ldr	r3, [sp, #12]
 241 00b0 8DF81C30 		strb	r3, [sp, #28]
  55:Model/dm4340_control.c **** 	dm43_can_send_data[5] = (kd_tmp >> 4); //kd高8位
 242              		.loc 1 55 2 is_stmt 1 view .LVU61
 243              		.loc 1 55 24 is_stmt 0 view .LVU62
 244 00b4 4FEA1919 		lsr	r9, r9, #4
 245              	.LVL21:
 246              		.loc 1 55 24 view .LVU63
 247 00b8 8DF81D90 		strb	r9, [sp, #29]
  56:Model/dm4340_control.c **** 	dm43_can_send_data[6] = ((kd_tmp&0xF)<<4)|(tor_tmp>>8); //kd低4位 + 转矩高4位
 248              		.loc 1 56 2 is_stmt 1 view .LVU64
 249              		.loc 1 56 43 is_stmt 0 view .LVU65
 250 00bc C0F30723 		ubfx	r3, r0, #8, #8
 251 00c0 43EA0813 		orr	r3, r3, r8, lsl #4
 252              		.loc 1 56 24 view .LVU66
 253 00c4 8DF81E30 		strb	r3, [sp, #30]
  57:Model/dm4340_control.c **** 	dm43_can_send_data[7] = tor_tmp; //转矩低8位
 254              		.loc 1 57 2 is_stmt 1 view .LVU67
 255              		.loc 1 57 24 is_stmt 0 view .LVU68
 256 00c8 8DF81F00 		strb	r0, [sp, #31]
  58:Model/dm4340_control.c **** 	
  59:Model/dm4340_control.c **** 	//Tx_Header.StdId=id;设置目标电机ID
  60:Model/dm4340_control.c **** 	//1: Tx_Header.IDE=CAN_ID_STD; 标准CAN_ID  0: Tx_Header.IDE=CAN_ID_EXT; 拓展CAN_ID 
  61:Model/dm4340_control.c **** 	//1: Tx_Header.RTR=CAN_RTR_REMOTE; 数据帧    0: Tx_Header.RTR=CAN_RTR_REMOTE; 数据帧
  62:Model/dm4340_control.c **** 	//Tx_Header.DLC=0x08; 8字节数据长度
  63:Model/dm4340_control.c **** 	if(CANx_SendStdData(hcan,id,dm43_can_send_data,8,1,1)!=0)
 257              		.loc 1 63 2 is_stmt 1 view .LVU69
 258              		.loc 1 63 5 is_stmt 0 view .LVU70
 259 00cc 0123     		movs	r3, #1
 260 00ce 0193     		str	r3, [sp, #4]
 261 00d0 0093     		str	r3, [sp]
 262 00d2 0823     		movs	r3, #8
 263 00d4 06AA     		add	r2, sp, #24
 264 00d6 0599     		ldr	r1, [sp, #20]
 265 00d8 0498     		ldr	r0, [sp, #16]
 266              	.LVL22:
 267              		.loc 1 63 5 view .LVU71
 268 00da FFF7FEFF 		bl	CANx_SendStdData
 269              	.LVL23:
  64:Model/dm4340_control.c **** 	{
  65:Model/dm4340_control.c **** 		//暂时没有调试，后面加上来
  66:Model/dm4340_control.c **** 	}
 270              		.loc 1 66 2 is_stmt 1 view .LVU72
  67:Model/dm4340_control.c **** }	
 271              		.loc 1 67 1 is_stmt 0 view .LVU73
 272 00de 09B0     		add	sp, sp, #36
 273              	.LCFI3:
 274              		.cfi_def_cfa_offset 44
 275              		@ sp needed
 276 00e0 BDEC028B 		vldm	sp!, {d8}
 277              	.LCFI4:
 278              		.cfi_restore 80
 279              		.cfi_restore 81
 280              		.cfi_def_cfa_offset 36
ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 7


 281 00e4 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 282              	.LVL24:
 283              	.L6:
 284              		.loc 1 67 1 view .LVU74
 285              		.align	2
 286              	.L5:
 287 00e8 00000000 		.word	0
 288 00ec 0000FA43 		.word	1140457472
 289              		.cfi_endproc
 290              	.LFE136:
 292              		.section	.text.ctrl_motor2,"ax",%progbits
 293              		.align	1
 294              		.global	ctrl_motor2
 295              		.syntax unified
 296              		.thumb
 297              		.thumb_func
 299              	ctrl_motor2:
 300              	.LVL25:
 301              	.LFB137:
  68:Model/dm4340_control.c **** 
  69:Model/dm4340_control.c **** void ctrl_motor2(CAN_HandleTypeDef* hcan,uint16_t id, float _pos, float _vel) //位置模式
  70:Model/dm4340_control.c **** {
 302              		.loc 1 70 1 is_stmt 1 view -0
 303              		.cfi_startproc
 304              		@ args = 0, pretend = 0, frame = 0
 305              		@ frame_needed = 0, uses_anonymous_args = 0
 306              		@ link register save eliminated.
  71:Model/dm4340_control.c **** //	uint8_t *pbuf,*vbuf;
  72:Model/dm4340_control.c **** //	pbuf=(uint8_t*)&_pos;
  73:Model/dm4340_control.c **** //	vbuf=(uint8_t*)&_vel;
  74:Model/dm4340_control.c **** //	
  75:Model/dm4340_control.c **** //	hcan->pTxMsg->StdId = id;
  76:Model/dm4340_control.c **** //	hcan->pTxMsg->IDE = CAN_ID_STD;
  77:Model/dm4340_control.c **** //	hcan->pTxMsg->RTR = CAN_RTR_DATA;
  78:Model/dm4340_control.c **** //	hcan->pTxMsg->DLC = 0x08;
  79:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[0] = *pbuf;
  80:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[1] = *(pbuf+1);
  81:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[2] = *(pbuf+2);
  82:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[3] = *(pbuf+3);
  83:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[4] = *vbuf;
  84:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[5] = *(vbuf+1);
  85:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[6] = *(vbuf+2);
  86:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[7] = *(vbuf+3);
  87:Model/dm4340_control.c **** //	
  88:Model/dm4340_control.c **** //	HAL_CAN_Transmit(hcan, 100);
  89:Model/dm4340_control.c **** }	
 307              		.loc 1 89 1 view .LVU76
 308 0000 7047     		bx	lr
 309              		.cfi_endproc
 310              	.LFE137:
 312              		.section	.text.ctrl_motor3,"ax",%progbits
 313              		.align	1
 314              		.global	ctrl_motor3
 315              		.syntax unified
 316              		.thumb
 317              		.thumb_func
 319              	ctrl_motor3:
ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 8


 320              	.LVL26:
 321              	.LFB138:
  90:Model/dm4340_control.c **** 
  91:Model/dm4340_control.c **** void ctrl_motor3(CAN_HandleTypeDef* hcan,uint16_t id, float _vel) //速度模式
  92:Model/dm4340_control.c **** {
 322              		.loc 1 92 1 view -0
 323              		.cfi_startproc
 324              		@ args = 0, pretend = 0, frame = 0
 325              		@ frame_needed = 0, uses_anonymous_args = 0
 326              		@ link register save eliminated.
  93:Model/dm4340_control.c **** //uint8_t *vbuf;
  94:Model/dm4340_control.c **** //	vbuf=(uint8_t*)&_vel;
  95:Model/dm4340_control.c **** //	
  96:Model/dm4340_control.c **** //	hcan->pTxMsg->StdId = id;
  97:Model/dm4340_control.c **** //	hcan->pTxMsg->IDE = CAN_ID_STD;
  98:Model/dm4340_control.c **** //	hcan->pTxMsg->RTR = CAN_RTR_DATA;
  99:Model/dm4340_control.c **** //	hcan->pTxMsg->DLC = 0x04;
 100:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[0] = *vbuf;
 101:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[1] = *(vbuf+1);
 102:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[2] = *(vbuf+2);
 103:Model/dm4340_control.c **** //	hcan->pTxMsg->Data[3] = *(vbuf+3);
 104:Model/dm4340_control.c **** //	
 105:Model/dm4340_control.c **** //	HAL_CAN_Transmit(hcan, 100);
 106:Model/dm4340_control.c **** }	
 327              		.loc 1 106 1 view .LVU78
 328 0000 7047     		bx	lr
 329              		.cfi_endproc
 330              	.LFE138:
 332              		.section	.text.start_motor,"ax",%progbits
 333              		.align	1
 334              		.global	start_motor
 335              		.syntax unified
 336              		.thumb
 337              		.thumb_func
 339              	start_motor:
 340              	.LVL27:
 341              	.LFB139:
 107:Model/dm4340_control.c **** 
 108:Model/dm4340_control.c **** void start_motor(CAN_HandleTypeDef* hcan,uint16_t id)
 109:Model/dm4340_control.c **** {
 342              		.loc 1 109 1 view -0
 343              		.cfi_startproc
 344              		@ args = 0, pretend = 0, frame = 8
 345              		@ frame_needed = 0, uses_anonymous_args = 0
 346              		.loc 1 109 1 is_stmt 0 view .LVU80
 347 0000 00B5     		push	{lr}
 348              	.LCFI5:
 349              		.cfi_def_cfa_offset 4
 350              		.cfi_offset 14, -4
 351 0002 85B0     		sub	sp, sp, #20
 352              	.LCFI6:
 353              		.cfi_def_cfa_offset 24
 110:Model/dm4340_control.c ****     uint8_t dm43_can_send_data[8];
 354              		.loc 1 110 5 is_stmt 1 view .LVU81
 111:Model/dm4340_control.c **** 
 112:Model/dm4340_control.c **** 	dm43_can_send_data[0] = 0xFF;
 355              		.loc 1 112 2 view .LVU82
ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 9


 356              		.loc 1 112 24 is_stmt 0 view .LVU83
 357 0004 FF23     		movs	r3, #255
 358 0006 8DF80830 		strb	r3, [sp, #8]
 113:Model/dm4340_control.c **** 	dm43_can_send_data[1] = 0xFF;
 359              		.loc 1 113 2 is_stmt 1 view .LVU84
 360              		.loc 1 113 24 is_stmt 0 view .LVU85
 361 000a 8DF80930 		strb	r3, [sp, #9]
 114:Model/dm4340_control.c **** 	dm43_can_send_data[2] = 0xFF;
 362              		.loc 1 114 2 is_stmt 1 view .LVU86
 363              		.loc 1 114 24 is_stmt 0 view .LVU87
 364 000e 8DF80A30 		strb	r3, [sp, #10]
 115:Model/dm4340_control.c **** 	dm43_can_send_data[3] = 0xFF;
 365              		.loc 1 115 2 is_stmt 1 view .LVU88
 366              		.loc 1 115 24 is_stmt 0 view .LVU89
 367 0012 8DF80B30 		strb	r3, [sp, #11]
 116:Model/dm4340_control.c **** 	dm43_can_send_data[4] = 0xFF;
 368              		.loc 1 116 2 is_stmt 1 view .LVU90
 369              		.loc 1 116 24 is_stmt 0 view .LVU91
 370 0016 8DF80C30 		strb	r3, [sp, #12]
 117:Model/dm4340_control.c **** 	dm43_can_send_data[5] = 0xFF;
 371              		.loc 1 117 2 is_stmt 1 view .LVU92
 372              		.loc 1 117 24 is_stmt 0 view .LVU93
 373 001a 8DF80D30 		strb	r3, [sp, #13]
 118:Model/dm4340_control.c **** 	dm43_can_send_data[6] = 0xFF;
 374              		.loc 1 118 2 is_stmt 1 view .LVU94
 375              		.loc 1 118 24 is_stmt 0 view .LVU95
 376 001e 8DF80E30 		strb	r3, [sp, #14]
 119:Model/dm4340_control.c **** 	dm43_can_send_data[7] = 0xFC;
 377              		.loc 1 119 2 is_stmt 1 view .LVU96
 378              		.loc 1 119 24 is_stmt 0 view .LVU97
 379 0022 FC23     		movs	r3, #252
 380 0024 8DF80F30 		strb	r3, [sp, #15]
 120:Model/dm4340_control.c **** 
 121:Model/dm4340_control.c **** 	//Tx_Header.StdId=id;设置目标电机ID
 122:Model/dm4340_control.c **** 	//1: Tx_Header.IDE=CAN_ID_STD; 标准CAN_ID  0: Tx_Header.IDE=CAN_ID_EXT; 拓展CAN_ID 
 123:Model/dm4340_control.c **** 	//1: Tx_Header.RTR=CAN_RTR_REMOTE; 数据帧    0: Tx_Header.RTR=CAN_RTR_REMOTE; 数据帧
 124:Model/dm4340_control.c **** 	//Tx_Header.DLC=0x08; 8字节数据长度
 125:Model/dm4340_control.c **** 
 126:Model/dm4340_control.c **** 	if(CANx_SendStdData(hcan, id, dm43_can_send_data, 8, 1, 1) != 0)
 381              		.loc 1 126 2 is_stmt 1 view .LVU98
 382              		.loc 1 126 5 is_stmt 0 view .LVU99
 383 0028 0123     		movs	r3, #1
 384 002a 0193     		str	r3, [sp, #4]
 385 002c 0093     		str	r3, [sp]
 386 002e 0823     		movs	r3, #8
 387 0030 0DEB0302 		add	r2, sp, r3
 388 0034 FFF7FEFF 		bl	CANx_SendStdData
 389              	.LVL28:
 127:Model/dm4340_control.c ****     {
 128:Model/dm4340_control.c ****         // 错误处理
 129:Model/dm4340_control.c ****     }
 390              		.loc 1 129 5 is_stmt 1 view .LVU100
 130:Model/dm4340_control.c **** 
 131:Model/dm4340_control.c **** }	
 391              		.loc 1 131 1 is_stmt 0 view .LVU101
 392 0038 05B0     		add	sp, sp, #20
 393              	.LCFI7:
ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 10


 394              		.cfi_def_cfa_offset 4
 395              		@ sp needed
 396 003a 5DF804FB 		ldr	pc, [sp], #4
 397              		.cfi_endproc
 398              	.LFE139:
 400              		.section	.text.lock_motor,"ax",%progbits
 401              		.align	1
 402              		.global	lock_motor
 403              		.syntax unified
 404              		.thumb
 405              		.thumb_func
 407              	lock_motor:
 408              	.LVL29:
 409              	.LFB140:
 132:Model/dm4340_control.c **** 
 133:Model/dm4340_control.c **** void lock_motor(CAN_HandleTypeDef* hcan,uint16_t id)
 134:Model/dm4340_control.c **** {
 410              		.loc 1 134 1 is_stmt 1 view -0
 411              		.cfi_startproc
 412              		@ args = 0, pretend = 0, frame = 8
 413              		@ frame_needed = 0, uses_anonymous_args = 0
 414              		.loc 1 134 1 is_stmt 0 view .LVU103
 415 0000 00B5     		push	{lr}
 416              	.LCFI8:
 417              		.cfi_def_cfa_offset 4
 418              		.cfi_offset 14, -4
 419 0002 85B0     		sub	sp, sp, #20
 420              	.LCFI9:
 421              		.cfi_def_cfa_offset 24
 135:Model/dm4340_control.c ****     uint8_t dm43_can_send_data[8];
 422              		.loc 1 135 5 is_stmt 1 view .LVU104
 136:Model/dm4340_control.c **** 
 137:Model/dm4340_control.c **** 	dm43_can_send_data[0] = 0xFF;
 423              		.loc 1 137 2 view .LVU105
 424              		.loc 1 137 24 is_stmt 0 view .LVU106
 425 0004 FF23     		movs	r3, #255
 426 0006 8DF80830 		strb	r3, [sp, #8]
 138:Model/dm4340_control.c **** 	dm43_can_send_data[1] = 0xFF;
 427              		.loc 1 138 2 is_stmt 1 view .LVU107
 428              		.loc 1 138 24 is_stmt 0 view .LVU108
 429 000a 8DF80930 		strb	r3, [sp, #9]
 139:Model/dm4340_control.c **** 	dm43_can_send_data[2] = 0xFF;
 430              		.loc 1 139 2 is_stmt 1 view .LVU109
 431              		.loc 1 139 24 is_stmt 0 view .LVU110
 432 000e 8DF80A30 		strb	r3, [sp, #10]
 140:Model/dm4340_control.c **** 	dm43_can_send_data[3] = 0xFF;
 433              		.loc 1 140 2 is_stmt 1 view .LVU111
 434              		.loc 1 140 24 is_stmt 0 view .LVU112
 435 0012 8DF80B30 		strb	r3, [sp, #11]
 141:Model/dm4340_control.c **** 	dm43_can_send_data[4] = 0xFF;
 436              		.loc 1 141 2 is_stmt 1 view .LVU113
 437              		.loc 1 141 24 is_stmt 0 view .LVU114
 438 0016 8DF80C30 		strb	r3, [sp, #12]
 142:Model/dm4340_control.c **** 	dm43_can_send_data[5] = 0xFF;
 439              		.loc 1 142 2 is_stmt 1 view .LVU115
 440              		.loc 1 142 24 is_stmt 0 view .LVU116
 441 001a 8DF80D30 		strb	r3, [sp, #13]
ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 11


 143:Model/dm4340_control.c **** 	dm43_can_send_data[6] = 0xFF;
 442              		.loc 1 143 2 is_stmt 1 view .LVU117
 443              		.loc 1 143 24 is_stmt 0 view .LVU118
 444 001e 8DF80E30 		strb	r3, [sp, #14]
 144:Model/dm4340_control.c **** 	dm43_can_send_data[7] = 0xFD;
 445              		.loc 1 144 2 is_stmt 1 view .LVU119
 446              		.loc 1 144 24 is_stmt 0 view .LVU120
 447 0022 FD23     		movs	r3, #253
 448 0024 8DF80F30 		strb	r3, [sp, #15]
 145:Model/dm4340_control.c ****         
 146:Model/dm4340_control.c **** 	if(CANx_SendStdData(hcan, id, dm43_can_send_data, 8, 1, 1) != 0)
 449              		.loc 1 146 2 is_stmt 1 view .LVU121
 450              		.loc 1 146 5 is_stmt 0 view .LVU122
 451 0028 0123     		movs	r3, #1
 452 002a 0193     		str	r3, [sp, #4]
 453 002c 0093     		str	r3, [sp]
 454 002e 0823     		movs	r3, #8
 455 0030 0DEB0302 		add	r2, sp, r3
 456 0034 FFF7FEFF 		bl	CANx_SendStdData
 457              	.LVL30:
 147:Model/dm4340_control.c ****     {
 148:Model/dm4340_control.c ****         // 错误处理
 149:Model/dm4340_control.c ****     }
 458              		.loc 1 149 5 is_stmt 1 view .LVU123
 150:Model/dm4340_control.c **** }	
 459              		.loc 1 150 1 is_stmt 0 view .LVU124
 460 0038 05B0     		add	sp, sp, #20
 461              	.LCFI10:
 462              		.cfi_def_cfa_offset 4
 463              		@ sp needed
 464 003a 5DF804FB 		ldr	pc, [sp], #4
 465              		.cfi_endproc
 466              	.LFE140:
 468              		.global	mtr
 469              		.section	.bss.mtr,"aw",%nobits
 470              		.align	2
 473              	mtr:
 474 0000 00000000 		.space	56
 474      00000000 
 474      00000000 
 474      00000000 
 474      00000000 
 475              		.text
 476              	.Letext0:
 477              		.file 2 "D:/enviroment/msys2/mingw64/arm-none-eabi/include/machine/_default_types.h"
 478              		.file 3 "D:/enviroment/msys2/mingw64/arm-none-eabi/include/sys/_stdint.h"
 479              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f446xx.h"
 480              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f4xx.h"
 481              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_can.h"
 482              		.file 7 "Model/dm4340_control.h"
 483              		.file 8 "Bsp/bsp_can.h"
ARM GAS  C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s 			page 12


DEFINED SYMBOLS
                            *ABS*:00000000 dm4340_control.c
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:21     .text.float_to_uint:00000000 $t
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:27     .text.float_to_uint:00000000 float_to_uint
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:66     .text.uint_to_float:00000000 $t
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:72     .text.uint_to_float:00000000 uint_to_float
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:111    .text.ctrl_motor:00000000 $t
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:117    .text.ctrl_motor:00000000 ctrl_motor
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:287    .text.ctrl_motor:000000e8 $d
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:293    .text.ctrl_motor2:00000000 $t
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:299    .text.ctrl_motor2:00000000 ctrl_motor2
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:313    .text.ctrl_motor3:00000000 $t
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:319    .text.ctrl_motor3:00000000 ctrl_motor3
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:333    .text.start_motor:00000000 $t
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:339    .text.start_motor:00000000 start_motor
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:401    .text.lock_motor:00000000 $t
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:407    .text.lock_motor:00000000 lock_motor
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:473    .bss.mtr:00000000 mtr
C:\Users\30514\AppData\Local\Temp\ccY6Nm8o.s:470    .bss.mtr:00000000 $d

UNDEFINED SYMBOLS
CANx_SendStdData
